$consoleApi = Add-Type -Name "ConsoleApi" -Namespace Win32 -PassThru -MemberDefinition '[DllImport("kernel32.dll", SetLastError = true)] public static extern IntPtr GetStdHandle(int nStdHandle);[DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]public static extern bool WriteConsole(IntPtr hConsoleOutput, string lpBuffer, uint nNumberOfCharsToWrite, out uint lpNumberOfCharsWritten, IntPtr lpReserved);'; $STD_OUTPUT_HANDLE = -11; $textToWrite = 'Printing text using the win32 api WriteConsole and the add-type cmdlet : This test worked correctly'; $handle = $consoleApi::GetStdHandle($STD_OUTPUT_HANDLE);$charsWritten = $null; if (-not $consoleApi::WriteConsole($handle, $textToWrite, $textToWrite.Length, [ref]$charsWritten, [IntPtr]::Zero)) { Write-Warning 'Failed to write to console!'; exit 2; }
